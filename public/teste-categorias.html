<!DOCTYPE html>
<html>
<head>
    <title>Teste Direto das Categorias</title>
</head>
<body>
    <h1>ğŸ§ª Teste das Categorias</h1>
    <button onclick="testarCategorias()">Testar Carregamento</button>
    <div id="resultado"></div>

    <script>
        async function testarCategorias() {
            console.log('ğŸ” Testando carregamento de categorias...');
            const resultado = document.getElementById('resultado');
            
            try {
                // Teste 1: Categorias de produtos
                console.log('ğŸ“¡ Tentando carregar categorias de produtos...');
                const resProdutos = await fetch('/api/categorias-produtos');
                console.log('Status produtos:', resProdutos.status);
                
                let htmlResult = '<h2>Resultado dos Testes:</h2>';
                
                if (resProdutos.ok) {
                    const dataProdutos = await resProdutos.json();
                    console.log('âœ… Categorias produtos:', dataProdutos);
                    
                    htmlResult += `<h3>âœ… Categorias de Produtos (${dataProdutos.data.length})</h3>`;
                    htmlResult += '<ul>';
                    dataProdutos.data.forEach(cat => {
                        htmlResult += `<li><strong>${cat.nome}</strong> - ${cat.tipo} - IVA: ${cat.taxa_iva_padrao}%</li>`;
                    });
                    htmlResult += '</ul>';
                } else {
                    const errorProdutos = await resProdutos.text();
                    console.error('âŒ Erro produtos:', errorProdutos);
                    htmlResult += `<h3>âŒ Erro ao carregar produtos:</h3><pre>${errorProdutos}</pre>`;
                }
                
                // Teste 2: Categorias de despesas
                console.log('ğŸ“¡ Tentando carregar categorias de despesas...');
                const resDespesas = await fetch('/api/categorias-despesas');
                console.log('Status despesas:', resDespesas.status);
                
                if (resDespesas.ok) {
                    const dataDespesas = await resDespesas.json();
                    console.log('âœ… Categorias despesas:', dataDespesas);
                    
                    htmlResult += `<h3>âœ… Categorias de Despesas (${dataDespesas.data.length})</h3>`;
                    htmlResult += '<ul>';
                    dataDespesas.data.forEach(cat => {
                        htmlResult += `<li><strong>${cat.nome}</strong> - DedutÃ­vel: ${cat.dedutivel_irt ? 'Sim' : 'NÃ£o'}</li>`;
                    });
                    htmlResult += '</ul>';
                } else {
                    const errorDespesas = await resDespesas.text();
                    console.error('âŒ Erro despesas:', errorDespesas);
                    htmlResult += `<h3>âŒ Erro ao carregar despesas:</h3><pre>${errorDespesas}</pre>`;
                }
                
                resultado.innerHTML = htmlResult;
                
            } catch (error) {
                console.error('âŒ Erro geral:', error);
                resultado.innerHTML = `<h3>âŒ Erro:</h3><pre>${error.message}</pre>`;
            }
        }
        
        // Teste automÃ¡tico ao carregar
        window.onload = () => {
            setTimeout(testarCategorias, 1000);
        };
    </script>
</body>
</html>