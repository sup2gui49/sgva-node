<!DOCTYPE html>
<html>
<head>
    <title>Teste Direto de Produto</title>
</head>
<body>
    <h1>üß™ Teste Formul√°rio de Produto</h1>
    <div>
        <h3>üìù Dados do Produto:</h3>
        <p>Nome: <input type="text" id="nome" value="Produto Teste Direto" /></p>
        <p>Categoria ID: <input type="number" id="categoria_id" value="1" /></p>
        <p>Categoria: <input type="text" id="categoria" value="Alimenta√ß√£o Geral" /></p>
        <p>Pre√ßo: <input type="number" id="preco" value="25.50" step="0.01" /></p>
        <p>Custo: <input type="number" id="custo" value="15.00" step="0.01" /></p>
        <p>Estoque: <input type="number" id="estoque" value="100" /></p>
        <button onclick="testarCriacao()">üöÄ Criar Produto</button>
    </div>
    <div id="resultado"></div>

    <script>
        async function testarCriacao() {
            console.log('üß™ Testando cria√ß√£o de produto...');
            const resultado = document.getElementById('resultado');
            
            const dados = {
                nome: document.getElementById('nome').value,
                categoria: document.getElementById('categoria').value,
                categoria_id: parseInt(document.getElementById('categoria_id').value),
                tipo: 'produto',
                unidade_medida: 'unidade',
                custo_unitario: parseFloat(document.getElementById('custo').value),
                preco_venda: parseFloat(document.getElementById('preco').value),
                estoque: parseInt(document.getElementById('estoque').value),
                estoque_minimo: 10,
                ativo: 1
            };
            
            console.log('üì§ Enviando:', dados);
            
            try {
                const response = await fetch('/api/produtos', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(dados)
                });
                
                const data = await response.json();
                console.log('üì® Resposta:', response.status, data);
                
                if (response.ok) {
                    resultado.innerHTML = `
                        <h2 style="color: green;">‚úÖ SUCESSO!</h2>
                        <p><strong>Produto:</strong> ${data.data.nome}</p>
                        <p><strong>ID:</strong> ${data.data.id}</p>
                        <p><strong>Pre√ßo:</strong> ${data.data.preco_venda} KZ</p>
                        <pre>${JSON.stringify(data, null, 2)}</pre>
                    `;
                } else {
                    resultado.innerHTML = `
                        <h2 style="color: red;">‚ùå ERRO!</h2>
                        <p><strong>Status:</strong> ${response.status}</p>
                        <p><strong>Mensagem:</strong> ${data.message}</p>
                        <pre>${JSON.stringify(data, null, 2)}</pre>
                    `;
                }
            } catch (error) {
                console.error('‚ùå Erro:', error);
                resultado.innerHTML = `
                    <h2 style="color: red;">‚ùå ERRO DE CONEX√ÉO!</h2>
                    <p>${error.message}</p>
                `;
            }
        }
        
        // Teste autom√°tico
        setTimeout(testarCriacao, 2000);
    </script>
</body>
</html>